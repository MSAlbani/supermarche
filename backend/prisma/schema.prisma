generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model clients {
  id_client          Int                  @id @default(autoincrement())
  nom_complet        String?              @db.VarChar(100)
  telephone          String?              @db.VarChar(30)
  type_client        String?              @db.VarChar(20)
  plafond_credit     Decimal?             @default(0) @db.Decimal(12, 2)
  actif              Boolean?             @default(true)
  date_creation      DateTime?            @default(now()) @db.Timestamp(6)
  reglements_clients reglements_clients[]
  ventes             ventes[]
}

model conditionnements {
  id_conditionnement         Int                          @id @default(autoincrement())
  libelle                    String                       @db.VarChar(50)
  quantite_unitaire          Decimal                      @db.Decimal(10, 2)
  id_produit                 Int?
  produits                   produits?                    @relation(fields: [id_produit], references: [id_produit], onDelete: NoAction, onUpdate: NoAction)
  lignes_facture_fournisseur lignes_facture_fournisseur[]
}

model details_vente {
  id_detail_vente     Int         @id @default(autoincrement())
  quantite            Decimal     @db.Decimal(10, 2)
  prix_vente_unitaire Decimal     @db.Decimal(12, 2)
  montant_ligne       Decimal     @db.Decimal(14, 2)
  id_vente            Int?
  id_lot              Int?
  lots_stock          lots_stock? @relation(fields: [id_lot], references: [id_lot], onDelete: NoAction, onUpdate: NoAction)
  ventes              ventes?     @relation(fields: [id_vente], references: [id_vente], onDelete: NoAction, onUpdate: NoAction)
}

model factures_fournisseurs {
  id_facture_fournisseur     Int                          @id @default(autoincrement())
  numero_facture             String                       @db.VarChar(50)
  date_facture               DateTime                     @db.Date
  montant_total              Decimal?                     @db.Decimal(14, 2)
  id_fournisseur             Int?
  id_utilisateur             Int?
  fournisseurs               fournisseurs?                @relation(fields: [id_fournisseur], references: [id_fournisseur], onDelete: NoAction, onUpdate: NoAction)
  utilisateurs               utilisateurs?                @relation(fields: [id_utilisateur], references: [id_utilisateur], onDelete: NoAction, onUpdate: NoAction)
  lignes_facture_fournisseur lignes_facture_fournisseur[]
  lots_stock                 lots_stock[]
}

model fournisseurs {
  id_fournisseur        Int                     @id @default(autoincrement())
  nom_fournisseur       String                  @db.VarChar(100)
  telephone             String?                 @db.VarChar(30)
  adresse               String?
  date_creation         DateTime?               @default(now()) @db.Timestamp(6)
  factures_fournisseurs factures_fournisseurs[]
  lots_stock            lots_stock[]
}

model lignes_facture_fournisseur {
  id_ligne_facture       Int                    @id @default(autoincrement())
  quantite               Decimal                @db.Decimal(10, 2)
  prix_achat_unitaire    Decimal                @db.Decimal(12, 2)
  date_peremption        DateTime?              @db.Date
  id_facture_fournisseur Int?
  id_produit             Int?
  id_conditionnement     Int?
  conditionnements       conditionnements?      @relation(fields: [id_conditionnement], references: [id_conditionnement], onDelete: NoAction, onUpdate: NoAction)
  factures_fournisseurs  factures_fournisseurs? @relation(fields: [id_facture_fournisseur], references: [id_facture_fournisseur], onDelete: NoAction, onUpdate: NoAction)
  produits               produits?              @relation(fields: [id_produit], references: [id_produit], onDelete: NoAction, onUpdate: NoAction)
}

model lots_stock {
  id_lot                 Int                    @id @default(autoincrement())
  quantite_initiale      Decimal                @db.Decimal(10, 2)
  quantite_restante      Decimal                @db.Decimal(10, 2)
  prix_achat_unitaire    Decimal                @db.Decimal(12, 2)
  date_peremption        DateTime?              @db.Date
  date_reception         DateTime?              @default(now()) @db.Timestamp(6)
  id_produit             Int?
  id_fournisseur         Int?
  id_facture_fournisseur Int?
  details_vente          details_vente[]
  factures_fournisseurs  factures_fournisseurs? @relation(fields: [id_facture_fournisseur], references: [id_facture_fournisseur], onDelete: NoAction, onUpdate: NoAction)
  fournisseurs           fournisseurs?          @relation(fields: [id_fournisseur], references: [id_fournisseur], onDelete: NoAction, onUpdate: NoAction)
  produits               produits?              @relation(fields: [id_produit], references: [id_produit], onDelete: NoAction, onUpdate: NoAction)
  mouvements_stock       mouvements_stock[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model mouvements_stock {
  id_mouvement   Int           @id @default(autoincrement())
  type_mouvement String?       @db.VarChar(20)
  quantite       Decimal       @db.Decimal(10, 2)
  date_mouvement DateTime?     @default(now()) @db.Timestamp(6)
  id_lot         Int?
  id_utilisateur Int?
  lots_stock     lots_stock?   @relation(fields: [id_lot], references: [id_lot], onDelete: NoAction, onUpdate: NoAction)
  utilisateurs   utilisateurs? @relation(fields: [id_utilisateur], references: [id_utilisateur], onDelete: NoAction, onUpdate: NoAction)
}

model prix_vente_produits {
  id_prix_vente Int       @id @default(autoincrement())
  prix_vente    Decimal   @db.Decimal(12, 2)
  date_debut    DateTime  @db.Date
  date_fin      DateTime? @db.Date
  actif         Boolean?  @default(true)
  id_produit    Int?
  produits      produits? @relation(fields: [id_produit], references: [id_produit], onDelete: NoAction, onUpdate: NoAction)
}

model produits {
  id_produit                 Int                          @id @default(autoincrement())
  code_produit               String                       @unique @db.VarChar(50)
  libelle                    String                       @db.VarChar(100)
  actif                      Boolean?                     @default(true)
  conditionnements           conditionnements[]
  lignes_facture_fournisseur lignes_facture_fournisseur[]
  lots_stock                 lots_stock[]
  prix_vente_produits        prix_vente_produits[]
}

model reglements_clients {
  id_reglement   Int           @id @default(autoincrement())
  montant        Decimal       @db.Decimal(14, 2)
  date_reglement DateTime?     @default(now()) @db.Timestamp(6)
  mode_reglement String?       @db.VarChar(30)
  id_client      Int?
  id_utilisateur Int?
  clients        clients?      @relation(fields: [id_client], references: [id_client], onDelete: NoAction, onUpdate: NoAction)
  utilisateurs   utilisateurs? @relation(fields: [id_utilisateur], references: [id_utilisateur], onDelete: NoAction, onUpdate: NoAction)
}

model roles {
  id_role      Int            @id @default(autoincrement())
  libelle      String         @unique @db.VarChar(50)
  utilisateurs utilisateurs[]
}

model utilisateurs {
  id_utilisateur        Int                     @id @default(autoincrement())
  nom_complet           String                  @db.VarChar(100)
  login                 String                  @unique @db.VarChar(50)
  mot_de_passe          String
  actif                 Boolean?                @default(true)
  id_role               Int?
  factures_fournisseurs factures_fournisseurs[]
  mouvements_stock      mouvements_stock[]
  reglements_clients    reglements_clients[]
  roles                 roles?                  @relation(fields: [id_role], references: [id_role], onDelete: NoAction, onUpdate: NoAction)
  ventes                ventes[]
}

/// This table contains check constraints and requires additional setup for migrations. Visit https://pris.ly/d/check-constraints for more info.
model ventes {
  id_vente        Int             @id @default(autoincrement())
  date_vente      DateTime?       @default(now()) @db.Timestamp(6)
  montant_total   Decimal?        @db.Decimal(14, 2)
  mode_paiement   String?         @db.VarChar(30)
  statut_paiement String?         @db.VarChar(20)
  id_client       Int?
  id_utilisateur  Int?
  details_vente   details_vente[]
  clients         clients?        @relation(fields: [id_client], references: [id_client], onDelete: NoAction, onUpdate: NoAction)
  utilisateurs    utilisateurs?   @relation(fields: [id_utilisateur], references: [id_utilisateur], onDelete: NoAction, onUpdate: NoAction)
}
